<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="www.zhizunbao.mapper.insure.InsureMapper" >
  <resultMap id="BaseResultMap" type="www.zhizunbao.dto.insure.Insure" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    <id column="insure_id" property="insureId" jdbcType="INTEGER" />
    <result column="insure_name" property="insureName" jdbcType="VARCHAR" />
    <result column="img_id" property="imgId" jdbcType="INTEGER" />
    <result column="img_src" property="imgSrc" jdbcType="VARCHAR" />
    <result column="insure_timelimit" property="insureTimelimit" jdbcType="INTEGER" />
    <result column="insure_content" property="insureContent" jdbcType="VARCHAR" />
    <result column="people_id" property="peopleId" jdbcType="INTEGER" />
    <result column="insure_number" property="insureNumber" jdbcType="INTEGER" />
    <result column="insure_shape" property="insureShape" jdbcType="VARCHAR" />
    <result column="insure_price" property="insurePrice" jdbcType="INTEGER" />
    <result column="people" property="people" jdbcType="VARCHAR" />
  </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    insure_id, insure_name, img_id, insure_timelimit, insure_content, people_id, insure_number, 
    insure_shape, insure_price
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    from insure
    where insure_id = #{insureId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    delete from insure
    where insure_id = #{insureId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="www.zhizunbao.dto.insure.Insure" useGeneratedKeys="true" keyProperty="insureId">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    insert into insure (insure_id, insure_name, img_id, 
      insure_timelimit, insure_content, people_id, 
      insure_number, insure_shape, insure_price
      )
    values (#{insureId,jdbcType=INTEGER}, #{insureName,jdbcType=VARCHAR}, #{imgId,jdbcType=INTEGER}, 
      #{insureTimelimit,jdbcType=INTEGER}, #{insureContent,jdbcType=VARCHAR}, #{peopleId,jdbcType=INTEGER}, 
      #{insureNumber,jdbcType=INTEGER}, #{insureShape,jdbcType=VARCHAR}, #{insurePrice,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="www.zhizunbao.dto.insure.Insure" useGeneratedKeys="true" keyProperty="insureId" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    insert into insure
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="insureId != null" >
        insure_id,
      </if>
      <if test="insureName != null" >
        insure_name,
      </if>
      <if test="imgId != null" >
        img_id,
      </if>
      <if test="insureTimelimit != null" >
        insure_timelimit,
      </if>
      <if test="insureContent != null" >
        insure_content,
      </if>
      <if test="peopleId != null" >
        people_id,
      </if>
      <if test="insureNumber != null" >
        insure_number,
      </if>
      <if test="insureShape != null" >
        insure_shape,
      </if>
      <if test="insurePrice != null" >
        insure_price,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="insureId != null" >
        #{insureId,jdbcType=INTEGER},
      </if>
      <if test="insureName != null" >
        #{insureName,jdbcType=VARCHAR},
      </if>
      <if test="imgId != null" >
        #{imgId,jdbcType=INTEGER},
      </if>
      <if test="insureTimelimit != null" >
        #{insureTimelimit,jdbcType=INTEGER},
      </if>
      <if test="insureContent != null" >
        #{insureContent,jdbcType=VARCHAR},
      </if>
      <if test="peopleId != null" >
        #{peopleId,jdbcType=INTEGER},
      </if>
      <if test="insureNumber != null" >
        #{insureNumber,jdbcType=INTEGER},
      </if>
      <if test="insureShape != null" >
        #{insureShape,jdbcType=VARCHAR},
      </if>
      <if test="insurePrice != null" >
        #{insurePrice,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  
  
  <update id="updateByPrimaryKeySelective" parameterType="www.zhizunbao.dto.insure.Insure" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    update insure
    <set >
      <if test="insureName != null" >
        insure_name = #{insureName,jdbcType=VARCHAR},
      </if>
      <if test="imgId != null" >
        img_id = #{imgId,jdbcType=INTEGER},
      </if>
      <if test="insureTimelimit != null" >
        insure_timelimit = #{insureTimelimit,jdbcType=INTEGER},
      </if>
      <if test="insureContent != null" >
        insure_content = #{insureContent,jdbcType=VARCHAR},
      </if>
      <if test="peopleId != null" >
        people_id = #{peopleId,jdbcType=INTEGER},
      </if>
      <if test="insureNumber != null" >
        insure_number = #{insureNumber,jdbcType=INTEGER},
      </if>
      <if test="insureShape != null" >
        insure_shape = #{insureShape,jdbcType=VARCHAR},
      </if>
      <if test="insurePrice != null" >
        insure_price = #{insurePrice,jdbcType=INTEGER},
      </if>
    </set>
    where insure_id = #{insureId,jdbcType=INTEGER}
  </update>
  
  <update id="updateByPrimaryKey" parameterType="www.zhizunbao.dto.insure.Insure" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 18 15:11:10 CST 2018.
    -->
    update insure
    set insure_name = #{insureName,jdbcType=VARCHAR},
      img_id = #{imgId,jdbcType=INTEGER},
      insure_timelimit = #{insureTimelimit,jdbcType=INTEGER},
      insure_content = #{insureContent,jdbcType=VARCHAR},
      people_id = #{peopleId,jdbcType=INTEGER},
      insure_number = #{insureNumber,jdbcType=INTEGER},
      insure_shape = #{insureShape,jdbcType=VARCHAR},
      insure_price = #{insurePrice,jdbcType=INTEGER}
    where insure_id = #{insureId,jdbcType=INTEGER}
  </update>
  
   <!-- findInsureList -->
  <select id="findInsureList" resultType="www.zhizunbao.dto.insure.Insure" resultMap="BaseResultMap" >
   select 
    	i.insure_id,i.insure_name,i.img_id,i.insure_timelimit,i.insure_content,i.people_id,i.insure_number,i.insure_shape,i.insure_price,ip.people,img.img_src
    from insure i
    left join insure_people ip on i.people_id=ip.people_id
	left join img  on img.img_id=i.img_id
    	where instr(i.insure_name,#{insureName,jdbcType=VARCHAR})
  </select>
  
  <!-- findInsureCount -->
  <select id="findInsureCount" resultType="int">
  	select count(1) from insure
  </select>
  
  <!-- findInsureListByPid -->
  <select id="findInsureListByPid" parameterType="java.lang.Integer" resultMap="BaseResultMap">
  	select
 	 img_src,t.type_name,i.insure_id,i.insure_name,i.img_id,i.insure_timelimit,i.insure_content,i.people_id,i.insure_number,i.insure_shape,i.insure_price
 	  from (select type_id,type_name,pid from type where pid=#{pid,jdbcType=VARCHAR}) t 
  		left join insure_type_tel itt on itt.type_id=t.type_id 
  		left join insure i on i.insure_id=itt.insure_id
  		left join img on img.img_id=i.img_id
  </select>
  
  <!-- findInsureListByTypeId -->
  <select id="findInsureListByTypeId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
  	select
 	 img_src,t.type_name,i.insure_id,i.insure_name,i.img_id,i.insure_timelimit,i.insure_content,i.people_id,i.insure_number,i.insure_shape,i.insure_price
 	  from (select type_id,type_name,pid from type where type_id=#{typeId,jdbcType=VARCHAR}) t 
  		left join insure_type_tel itt on itt.type_id=t.type_id 
  		left join insure i on i.insure_id=itt.insure_id
  		left join img on img.img_id=i.img_id
  </select>
  
  <!-- findInsureByInsureId -->
  <select id="findInsureByInsureId" parameterType="java.lang.Integer" resultMap="BaseResultMap">
  	SELECT 
  	 ins.insure_id,ins.insure_name,insure_timelimit,ins.insure_content,ins.insure_shape,ins.insure_number,ins.insure_price,img.img_src,p.people
	from insure ins 
		LEFT JOIN insure_people p ON p.people_id=ins.people_id
		LEFT JOIN img ON img.img_id=ins.img_id
		 WHERE ins.insure_id=#{insureId,jdbcType=INTEGER}
  </select>
  
  <!-- findInsureById -->
  <select id="findInsureNameAndImgSrcById" parameterType="java.lang.Integer" resultMap="BaseResultMap" >
  	SELECT ins.insure_id,ins.insure_name,ins.img_id,img.img_src 
	  FROM insure ins
		LEFT JOIN img 
		ON img.img_id=ins.img_id 
		where ins.insure_id=#{insureId,jdbcType=INTEGER}
  </select>
  
  <!-- updateInsureUp -->
  <update id="updateInsureUp" parameterType="java.lang.Integer">
  	update insure
  	set insure_number = (insure_number+1)
  	where insure_id=#{insureId,jdbcType=INTEGER}
  </update>
  
</mapper>